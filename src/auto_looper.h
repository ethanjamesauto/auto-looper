// run the main state machine and get the next sample
int16_t get_next_sample(int16_t current);